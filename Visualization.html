<!Doctype html>
<html>
<head>
	<meta charset="ISO-8859-1">
  	<script src="http://d3js.org/d3.v4.min.js"></script>
  	<script src="http://dimplejs.org/dist/dimple.v2.3.0.min.js"></script>
  	<script type="text/javascript" 
  	src="http://gc.kis.v2.scr.kaspersky-labs.com/50DD6F45-961C-3842-A169-C5C68AC05B12/main.js" charset="UTF-8"></script>
  	<script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
  	<style>

    h2 {
       position: relative;
       left: 700px;
       font-size:30px;

       }

    h2.yaxist {position: absolute;
    		left: -20px;
    		top: 400px;
    	  transform: rotate(-90deg);	
    	  }

    h2.xaxist {position: absolute;
    		  top: 900px;
    		  left:850px;}

    svg {position:absolute;
    	 top:10px;
    	 left:200px;}

    div.Difference_Type {
        position: absolute;
        top: 590px;
        left: 1920px;
      }

   div.Difference_Type div {
        background-color: rgb(251, 201, 127);
        padding: 3px;
        margin: 7px;
      }


/*    div.button {
        position: fixed;
        top: 0px;
        left: 0px;
      }*/

  </style>
  <script type="text/javascript">
      function draw(data) {
      	  console.log(data)
   
          "use strict";
          var margin = 100,
              width = 1800 - margin,
              height = 1000 - margin;
          
          d3.select('body')
            .append('h2')
            .classed("title",true)
            .text("Average Differences between Students Across Survey Indicators");

          d3.select('body')
          	.append('h2')
          	.classed("xaxist",true)
          	.text("Average Differences due to Closeness");

          d3.select("body")
          	.append('h2')
          	.classed("yaxist",true)
          	.text("Average Differences due to Basic Participation");
 

          div=d3.select('body')
            .append('div')
            .attr("class","tooltip")
            .style("opacity",0);

          var svg = d3.select("body")
            .append("svg")
              .attr("width", 4000 + margin)
              .attr("height", 1000 + margin)
              .append('g')
              .attr('class','chart');

          
         var close_extent = [-.5,.5];

         var close_scale = d3.scaleLinear()
              .range([margin,width])
              .domain(close_extent);

         var wclose_extent = [-.5,.5];

         var wclose_scale = d3.scaleLinear()
              .range([height, margin])
              .domain(wclose_extent);

         var close_axis = d3.axisBottom()
              .scale(close_scale);

         var wclose_axis = d3.axisLeft()
              .scale(wclose_scale);

 	     var tip = d3.select('body')
      				.append('div')
      				.attr('class', 'tip')
			      	.style('padding', '5px')
			     	.style('position', 'absolute')
			     	.style('top','450px')
			   		.style('left','1920px')
			   		.style("color","#50000")
			   		.style("font-size","16pt")
			     	.style('display', 'none')
			     	.on('mouseover', function(d, i) {
			     	   tip.transition().duration(0);
			     		 })
			      	.on('mouseout', function(d, i) {
			        	tip.style('display', 'none');
			      		});
;

		var area=d3.area()
        			.x(function(d)  {return close_scale(d[0]);})
        			.y1(function(d) {return wclose_scale(d[1]);});


        d3.select('svg')
        	.append("path")
        	.datum([[-.5,.2],[.5,.2],[.5,.5],[-.5,.5]])
        	.attr("class","area1")
        	.attr('fill','#ffe4b2')
        	.attr("d",area)
        	.style("opacity",.5)
        	.on('mouseover', function(d, i) {
        						tip.transition().duration(0);
        						tip.style('display', 'block');
      							tip.html("Medium Difference");})
            .on('mouseout', function(d, i){tip.transition()
        							.delay(500)
        							.style('display', 'none');
      								});

        d3.select('svg')
        	.append("path")
        	.datum([[-.5,0],[.5,0],[.5,.2],[-.5,.2]])
        	.attr("class","area2")
        	.attr('fill','#ffedcc')
        	.attr("d",area)
        	.style("opacity",.5)
        	.on('mouseover', function(d, i) {
        						tip.transition().duration(0);
        						tip.style('display', 'block');
      							tip.html("Small Difference")})
            .on('mouseout', function(d, i){tip.transition()
        							.delay(500)
        							.style('display', 'none');
      								});;



        d3.select('svg')
        	.append("path")
        	.datum([[.2,.5],[.5,.5],[.5,-.5],[.2,-.5]])
        	.attr("class","area3")
        	.attr('fill','#ccddea')
        	.attr("d",area)
        	.style("opacity",.5)
        	.on('mouseover', function(d, i) {
        						tip.transition().duration(0);
        						tip.style('display', 'block');
      							tip.html("Medium Difference")})
            .on('mouseout', function(d, i){tip.transition()
        							.delay(500)
        							.style('display', 'none');
      								});;

        d3.select('svg')
        	.append("path")
        	.datum([[0,.5],[.2,.5],[.2,-.5],[0,-.5]])
        	.attr("class","area4")
        	.attr('fill','#dde8f1')
        	.attr("d",area)
        	.style("opacity",.5)
        	.on('mouseover', function(d, i) {
        						tip.transition().duration(0);
        						tip.style('display', 'block');
      							tip.html("Small Difference")})
            .on('mouseout', function(d, i){tip.transition()
        							.delay(500)
        							.style('display', 'none');
      								});;
 
    

        d3.select('svg')
            .selectAll("image")
            .data(data)
            .enter()
            .append("svg:image")
            .attr("xlink:href",function(d){if (d['Type']=="Academic and Personal Behaviors and Attitudes")
              						{return "https://www.mimh.edu/content/themes/mimh/assets/img/icon-innovative-research.png";}
              				else if (d['Type']=="College and Career Aspirations")
              						{return "http://www.pvhc.net/img205/uzlyilygqewwvktiurhs.png";}
              				else    {return "https://cdn4.iconfinder.com/data/icons/people-40/48/worker_female-512.png";}});

        // d3.select('svg')
        //     .selectAll("circle")
        //     .data(data)
        //     .enter()
        //     .append("circle");

        d3.select("svg")
              .append('g')
              .attr('class', 'x_axis')
              .attr("transform", "translate(0,"+wclose_scale(0)+")")
              .call(close_axis);

        d3.select("svg")
              .append('g')
              .attr('class', 'y_axis')
              .attr("transform", "translate("+ close_scale(0) +",0)")
              .call(wclose_axis);

 		d3.selectAll('image')
        	  .classed('graph1',true)
              .attr('x', function(d) {
                  return close_scale(d['Difference1'])-13;
              		})
              .attr('y', function(d) {
                  return wclose_scale(d['Difference2'])-13;
              		})
              .attr('opacity',.85)
              .attr('width', 30)
			  .attr('height', 30)
              .attr('color', function(d){
              				if (d['Type']=="Academic and Personal Behaviors and Attitudes")
              						{return "#7570b3";}
              				else if (d['Type']=="College and Career Aspirations")
              						{return "#d95f02";}
              				else    {return "#1b9e77";}})
              .on('mouseover', function(d, i) {
        						tip.transition().duration(0);
        						tip.style('display', 'block');
      							tip.html(function(){if (d["Type"]=="Academic and Personal Behaviors and Attitudes")
      												{return d["Type"]+"<br>Closeness Effect Size: "+d['Difference1']+
      											   "<br>Participation Effect Size: "+d["Difference2"]+
      											   "<br>Scale: Rating 0-3";}
      											   else {return d["Type"]+"<br>Closeness Effect Size: "+d['Difference1']+
      											   "<br>Participation Effect Size: "+d["Difference2"]+
      											   "<br>Scale: %";}});

      							})
      		  .on('mouseout', function(d, i) {
        							tip.transition()
        							.delay(500)
        							.style('display', 'none');
      								});




		
        // d3.selectAll('circle')
        // 	  .classed('graph',true)
        //       .attr('cx', function(d) {
        //           return close_scale(d['Difference1']);
        //       		})
        //       .attr('cy', function(d) {
        //           return wclose_scale(d['Difference2']);
        //       		})
        //       .attr('opacity',.85)
        //       .attr('r', 9)
        //       .attr('fill', function(d){
        //       				if (d['Type']=="Academic and Personal Behaviors and Attitudes")
        //       						{return "#7570b3";}
        //       				else if (d['Type']=="College and Career Aspirations")
        //       						{return "#d95f02";}
        //       				else    {return "#1b9e77";}})
        //       .on('mouseover', function(d, i) {
        // 						tip.transition().duration(0);
        // 						tip.style('display', 'block');
      		// 					tip.html(function(){if (d["Type"]=="Academic and Personal Behaviors and Attitudes")
      		// 										{return d["Type"]+"<br>Closeness Effect Size: "+d['Difference1']+
      		// 									   "<br>Participation Effect Size: "+d["Difference2"]+
      		// 									   "<br>Scale: Rating 0-3";}
      		// 									   else {return d["Type"]+"<br>Closeness Effect Size: "+d['Difference1']+
      		// 									   "<br>Participation Effect Size: "+d["Difference2"]+
      		// 									   "<br>Scale: %";}});

      		// 					})
      		//   .on('mouseout', function(d, i) {
        // 							tip.transition()
        // 							.delay(500)
        // 							.style('display', 'none');
      		// 						});

        var legend = svg.append("g")
		                .attr("class", "legend")
		                .attr("transform", "translate(" + (1800) + "," + 100 + ")")
		                .selectAll("g")
		                .data(["Academic and Personal Behaviors and Attitudes",
		                	   "College and Career Aspirations",
		                	   "College and Career Activities"])
		                .enter()
					    .append("g");

		var colors1 = ["#7570b3","#d95f02","#1b9e77"];
		var colors2 = ['#ffe4b2','#ffedcc','#ccddea','#dde8f1']
		var links   = ["https://www.mimh.edu/content/themes/mimh/assets/img/icon-innovative-research.png",
						"http://www.pvhc.net/img205/uzlyilygqewwvktiurhs.png",
						"https://cdn4.iconfinder.com/data/icons/people-40/48/worker_female-512.png"
						]

		legend.append("image")
		 	  .attr("y", function(d, i) {
	                 return (i * 30+50)-13;
		              })
		      .attr("x",-55-13)
		      .attr('width', 30)
			  .attr('height', 30)
		      .attr("xlink:href", function(d,i){return links[i];});

		// legend.append("circle")
 	// 		  .attr("cy", function(d, i) {
  //                 return i * 30+50;
  //             })
  //             .attr("cx",-55)
  //             .attr("r", function(d) {return 8;})
  //             .attr("fill", function(d,i){return colors1[i];});

        var legend1 = svg.append("g")
        				.attr("class", "legend1")
		                .attr("transform", "translate(" + (1800) + "," + 300 + ")")
		                .selectAll("g")
		                .data(["Medium Difference","Small Difference",
		                	   "Medium Difference","Small Difference"])
		                .enter()
					    .append("g");
        				



        legend.append("text")
        	  .attr("y", function(d, i) {
                  return i * 30 + 55;})
              .attr("x", 10 * 5-80)
              .style("font-size",22)
              .text(function(d) {
                  		return d;})


    	legend.append("text")
        	  .attr("y", 20)
              .attr("x", -40)
              .style("font-size",25)
              .style("font-weight","bold")
              .text("Question Types")

        legend1.append("rect")
        	  .attr("y", function(d,i){return i*30;})
        	  .attr("x",-65)
 			  .attr("height", 18)
 			  .attr("width", 18)
              .attr("fill", function(d,i) {return colors2[i];});

        legend1.append("text")
        	  .attr("y", function(d, i) {
                  return i * 30 + 18.5-5;})
              .attr("x", 10 * 5-80)
              .style("font-size",22)
              .text(function(d) {
                  		return d;})

        legend1.append("text")
        	  .attr("y", -30)
              .attr("x", -40)
              .style("font-size",25)
              .style("font-weight","bold")
              .text("Difference Types")

       function update(diftype) {
       		if (diftype=="Closeness") {

       			d3.select("svg").selectAll(".graph1")
       			  .attr("x", function(data) {
                  return close_scale(data['Difference1'])-13});
       			d3.select('.title')
       			  .text("Average Differences between Students Across Survey Indicators")
       			  .style("left","700px");
       			d3.select('.y_axis')
       			  .style('display','initial');
       			d3.select('.area3')
       			  .style('display','initial');
       			d3.select('.area4')
       			  .style('display','initial');
       			d3.select('.yaxist')
       			  .style('display','initial');
       			d3.select('.xaxist')
       			  .style('display','initial');
       			d3.select('.legend1>g:nth-child(3)').attr('display','initial');
       			d3.select('.legend1>g:nth-child(4)').attr('display','initial');





       			d3.select("svg").selectAll(".graph1")
       			  .attr("y",wclose_scale(0)-13);
       			d3.select('.title')
       			  .text("Average Differences due to Closeness")
       			  .style("left","875px");
       			d3.select('.x_axis')
       			  .style('display','none');
       			d3.select('.area1')
       			  .style('display','none');
       			d3.select('.area2')
       			  .style('display','none');
       			d3.select('.yaxist')
       			  .style('display','none');
       			d3.select('.xaxist')
       			  .style('display','none');
       			d3.select('.legend1>g:nth-child(1)').attr('display','none');
       			d3.select('.legend1>g:nth-child(2)').attr('display','none');
       			d3.select('.legend1>g:nth-child(3)')
       			  .select('rect').attr('y',-10);
       			d3.select('.legend1>g:nth-child(3)')
       			  .select('text').attr('y',5);
       			d3.select('.legend1>g:nth-child(4)')
       		      .select('rect').attr('y',20);
       		    d3.select('.legend1>g:nth-child(4)')
       		      .select('text').attr('y',35);
       									}

       		else if (diftype=="Basic Participation") {

       			d3.select("svg").selectAll(".graph1")
       			  .attr("y", function(data) {
                  return wclose_scale(data['Difference2'])-13});
       			d3.select('.title')
       			  .text("Average Differences between Students Across Survey Indicators")
       			  .style("left","300px");
       			d3.select('.x_axis')
       			  .style('display','initial');
       			d3.select('.area1')
       			  .style('display','initial');
       			d3.select('.area2')
       			  .style('display','initial');
       			d3.select('.yaxist')
       			  .style('display','initial');
       			d3.select('.xaxist')
       			  .style('display','initial');
       			d3.select('.legend1>g:nth-child(1)').attr('display','initial');
       			d3.select('.legend1>g:nth-child(2)').attr('display','initial');
       			d3.select('.legend1>g:nth-child(3)')
       			  .select('rect').attr('y',60);
       			d3.select('.legend1>g:nth-child(3)')
       			  .select('text').attr('y',73.5);
       			d3.select('.legend1>g:nth-child(4)')
       		      .select('rect').attr('y',90);
       		    d3.select('.legend1>g:nth-child(4)')
       		      .select('text').attr('y',103.5);


       		    d3.select("svg").selectAll(".graph1")
       			  .attr("x",close_scale(0)-13);
       			d3.select('.title')
       			  .text("Average Differences due to Basic Participation")
       			  .style("left","875px");
       			d3.select('.y_axis')
       			  .style('display','none');
       			d3.select('.area3')
       			  .style('display','none');
       			d3.select('.area4')
       			  .style('display','none');
       			d3.select('.yaxist')
       			  .style('display','none');
       			d3.select('.xaxist')
       			  .style('display','none');
       			d3.select('.legend1>g:nth-child(3)').attr('display','none');
       			d3.select('.legend1>g:nth-child(4)').attr('display','none');
       		}
		else  {
			    d3.select("svg").selectAll(".graph1")
       			  .attr("y", function(data) {
                  return wclose_scale(data['Difference2'])-13})
                  .attr("x",function(data) {
                  return close_scale(data['Difference1'])-13});
       			d3.select('.title')
       			  .text("Average Differences between Students Across Survey Indicators")
       			  .style("left","700px");
       			d3.select('.x_axis')
       			  .style('display','initial');
       			d3.select('.y_axis')
       			  .style('display','initial');
       			d3.select('.area1')
       			  .style('display','initial');
       			d3.select('.area2')
       			  .style('display','initial');
       			d3.select('.area3')
       			  .style('display','initial');
       			d3.select('.area4')
       			  .style('display','initial')
       			d3.select('.yaxist')
       			  .style('display','initial');
       			d3.select('.xaxist')
       			  .style('display','initial');
       			d3.select('.legend1>g:nth-child(1)').attr('display','initial');
       			d3.select('.legend1>g:nth-child(2)').attr('display','initial');
       			d3.select('.legend1>g:nth-child(3)').attr('display','initial');
       			d3.select('.legend1>g:nth-child(4)').attr('display','initial');
       			d3.select('.legend1>g:nth-child(3)')
       			  .select('rect').attr('y',60);
       			d3.select('.legend1>g:nth-child(3)')
       			  .select('text').attr('y',73.5);
       			d3.select('.legend1>g:nth-child(4)')
       		      .select('rect').attr('y',90);
       		    d3.select('.legend1>g:nth-child(4)')
       		      .select('text').attr('y',103.5);

            } ;
       		

          
 
        };

        var buttons = d3.select("body")
                .append("div")
                .attr("class", "Difference_Type")
                .selectAll("div")
                .data(["Closeness","Basic Participation","Close and Basic"])
                .enter()
                .append("div")
                .text(function(d) {
                    return d;
                	})
                .style('font-size',"15pt")
                .style('border','outset')
                .style('border-color','coral');


        buttons.on("click", function(d) {
            d3.select(".Difference_Type")
              .selectAll("div")
              .transition()
              .duration(500)
              .style("color", "black")
              .style("background", "rgb(251, 201, 127)");
             
            d3.select(this)
              .transition()
              .duration(500)
              .style("background", "lightBlue")
              .style("color", "white");
      
            update(diftype=d);
             
        });        


   }





  </script>
  </head>
  <body>
  <script type="text/javascript">
  format = d3.timeFormat("%d-%m-%Y (%H:%M h)")
  d3.csv("IMentor.csv",function(d) {d["Difference1"] =parseFloat(d["Difference1"]);
  									d["Difference2"] = parseFloat(d["Difference2"]);
  									return d;},draw
  		);
  /* var loadDsv = d3.dsv(",", "ISO-8859-1");
  loadDsv("sample.csv",draw); */
  </script>
</body>
</html>

    
  